{# =========================
   components/navbar.njk â€” Hyper style v2 (spin + corner glow)
   ========================= #}
<nav class="hb-navbar navbar navbar-expand-lg component" data-component-id="navbar">
  <div class="container py-2">
    {% if global.components.navbar.show_shop_name or global.components.navbar.show_logo %}
    <a class="navbar-brand fw-bold" href="{{ '/' | shopUrl }}">
      {% if global.components.navbar.show_logo and shop.image_url %}
        <img src="{{ shop.image_url }}" alt="{{ shop.name }}" />
      {% endif %}
      {% if global.components.navbar.show_shop_name %}
        <span>{{ shop.name }}</span>
      {% endif %}
    </a>
    {% endif %}

    <div class="d-flex gap-2 align-items-center">
      {% if not global.components.navbar.hide_cart %}
      <div class="cart d-md-none">
        <a class="btn cart-btn" href="{{ '/cart' | shopUrl }}">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M7 22q-.825 0-1.412-.587T5 20t.588-1.412T7 18t1.413.588T9 20t-.587 1.413T7 22m10 0q-.825 0-1.412-.587T15 20t.588-1.412T17 18t1.413.588T19 20t-.587 1.413T17 22M6.15 6l2.4 5h7l2.75-5zM5.2 4h14.75q.575 0 .875.513t.025 1.037l-3.55 6.4q-.275.5-.737.775T15.55 13H8.1L7 15h11q.425 0 .713.288T19 16t-.288.713T18 17H7q-1.125 0-1.7-.987t-.05-1.963L6.6 11.6L3 4H2q-.425 0-.712-.288T1 3t.288-.712T2 2h1.625q.275 0 .525.15t.375.425zm3.35 7h7z"/></svg>
          <template x-if="appCart.countWithQuantities > 0">
            <span class="count">
              <span x-text="appCart.countWithQuantities > 9 ? '9+' : appCart.countWithQuantities"></span>
            </span>
          </template>
        </a>
      </div>
      {% endif %}

      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        {% for link in global.components.navbar.left_links %}
        <li class="nav-item">
          <a class="nav-link" href="{{ link.link | shopUrl }}" target="{{ 'blank' if link.new_tab }}">
            {{ link.text if link.text else 'New Link' }}
          </a>
        </li>
        {% endfor %}
      </ul>

      <ul class="navbar-nav gap-3 align-items-center">
        {% for link in global.components.navbar.right_links %}
        <li class="nav-item">
          <a class="nav-link" href="{{ link.link | shopUrl }}" target="{{ 'blank' if link.new_tab }}">
            {{ link.text if link.text else 'New Link' }}
          </a>
        </li>
        {% endfor %}

        {% if not global.components.navbar.hide_currency_selector and currency_rates_usd | length > 1 %}
        <li class="nav-item">
          <div class="currency-selector lg">
            <select>
              {% for code, rate in currency_rates_usd %}
                <option value="{{ code }}">{{ code.toUpperCase() }}</option>
              {% endfor %}
            </select>
          </div>
        </li>
        {% endif %}

        {% if not global.components.navbar.hide_customer_dashboard %}
        <li class="nav-item user d-none d-lg-block">
          {% if shop_customer %}
            <a href="{{ '/customer/dashboard' | shopUrl }}" class="nav-ghost">My Account</a>
          {% else %}
            <button type="button" data-bs-toggle="modal" data-bs-target="#customer-login-modal" class="nav-ghost">Login</button>
          {% endif %}
        </li>
        {% endif %}

        <li class="nav-item">
          <a class="discord-cta" href="{{ shop.discord_url or 'https://discord.gg/zEcVQhTr' }}" target="_blank" rel="noopener">
            <i class="fa-brands fa-discord"></i> Discord
          </a>
        </li>

        {% if not global.components.navbar.hide_cart %}
        <li class="nav-item cart d-none d-lg-block">
          <a class="nav-ghost cart-btn" href="{{ '/cart' | shopUrl }}">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24"><path fill="currentColor" d="M7 22q-.825 0-1.412-.587T5 20t.588-1.412T7 18t1.413.588T9 20t-.587 1.413T7 22m10 0q-.825 0-1.412-.587T15 20t.588-1.412T17 18t1.413.588T19 20t-.587 1.413T17 22M6.15 6l2.4 5h7l2.75-5zM5.2 4h14.75q.575 0 .875.513t.025 1.037l-3.55 6.4q-.275.5-.737.775T15.55 13H8.1L7 15h11q.425 0 .713.288T19 16t-.288.713T18 17H7q-1.125 0-1.7-.987t-.05-1.963L6.6 11.6L3 4H2q-.425 0-.712-.288T1 3t.288-.712T2 2h1.625q.275 0 .525.15t.375.425zm3.35 7h7z"/></svg>
            <template x-if="appCart.countWithQuantities > 0">
              <span class="count">
                <span x-text="appCart.countWithQuantities > 9 ? '9+' : appCart.countWithQuantities"></span>
              </span>
            </template>
          </a>
        </li>
        {% endif %}
      </ul>
    </div>
  </div>
</nav>

<style>
.hb-navbar[data-component-id="navbar"]{
  --accent: var(--mono-accent, #ff5aa0);
  --bg: rgba(18,12,18,.55);
  --stroke: rgba(255,255,255,.06);
  position: sticky; top: 0; z-index: 30;
  backdrop-filter: blur(8px);
  background: linear-gradient(180deg, rgba(255,90,160,.08), transparent 32%) , var(--bg);
  border-bottom: 1px solid var(--stroke);
}
.hb-navbar[data-component-id="navbar"]::before{
  content:""; position: absolute; inset:0 0 auto 0; height:4px;
  background: linear-gradient(90deg, transparent, #ff88bd, var(--accent), #ff88bd, transparent);
  background-size: 200% 100%; animation: hbTopline 8s linear infinite;
}
@keyframes hbTopline{ to{ background-position: -200% 0 } }

.hb-navbar[data-component-id="navbar"] .container{ gap: 12px; }

.hb-navbar[data-component-id="navbar"] .navbar-brand{
  display:flex; align-items:center; gap:10px; color:#fff; text-decoration:none;
  font-weight:900; letter-spacing:.01em;
}
.hb-navbar[data-component-id="navbar"] .navbar-brand img{
  height:28px; width:auto; border-radius:6px;
  box-shadow: 0 4px 12px rgba(0,0,0,.25);
}

.hb-navbar[data-component-id="navbar"] .nav-link,
.hb-navbar[data-component-id="navbar"] .nav-ghost{
  position:relative; color:#dedee6; font-weight:700; padding:10px 12px;
  text-decoration:none; display:inline-flex; align-items:center; gap:8px;
  border-radius:10px; transition: color .2s ease, transform .2s ease, background .2s ease;
  background:
    radial-gradient(140px 60px at var(--mx,50%) var(--my,120%),
      rgba(255,90,160,.18), transparent 60%);
}
.hb-navbar[data-component-id="navbar"] .nav-link::before,
.hb-navbar[data-component-id="navbar"] .nav-link::after,
.hb-navbar[data-component-id="navbar"] .nav-ghost::before,
.hb-navbar[data-component-id="navbar"] .nav-ghost::after{
  content:""; position:absolute; inset:6px; pointer-events:none; opacity:0; transition:opacity .2s ease;
  background:
    linear-gradient(var(--accent), var(--accent)) left top/14px 2px no-repeat,
    linear-gradient(var(--accent), var(--accent)) left top/2px 14px no-repeat,
    linear-gradient(var(--accent), var(--accent)) right bottom/14px 2px no-repeat,
    linear-gradient(var(--accent), var(--accent)) right bottom/2px 14px no-repeat;
  border-radius:10px;
}
.hb-navbar[data-component-id="navbar"] .nav-link:hover,
.hb-navbar[data-component-id="navbar"] .nav-ghost:hover{
  color:#fff; transform: translateY(-1px);
}
.hb-navbar[data-component-id="navbar"] .nav-link:hover::before,
.hb-navbar[data-component-id="navbar"] .nav-link:hover::after,
.hb-navbar[data-component-id="navbar"] .nav-ghost:hover::before,
.hb-navbar[data-component-id="navbar"] .nav-ghost:hover::after{ opacity:1; }

.hb-navbar[data-component-id="navbar"] .nav-link.active{ color:#fff; }
.hb-navbar[data-component-id="navbar"] .nav-link.active::before,
.hb-navbar[data-component-id="navbar"] .nav-link.active::after{ opacity:1; }

.hb-navbar[data-component-id="navbar"] .discord-cta{
  position:relative; overflow:hidden;
  display:inline-flex; align-items:center; gap:8px; padding:10px 14px;
  border-radius:12px; color:#101114; text-decoration:none; font-weight:900;
  background: linear-gradient(90deg,#ff88bd,var(--accent));
  box-shadow: 0 10px 24px rgba(255,90,160,.28), inset 0 1px 0 rgba(255,255,255,.22);
  transition: transform .18s ease, box-shadow .18s ease;
}
.hb-navbar[data-component-id="navbar"] .discord-cta i{
  transition: transform .65s cubic-bezier(.22,1,.36,1);
}
.hb-navbar[data-component-id="navbar"] .discord-cta:hover{
  transform: translateY(-2px);
  box-shadow: 0 14px 30px rgba(255,90,160,.35), inset 0 1px 0 rgba(255,255,255,.22);
}
.hb-navbar[data-component-id="navbar"] .discord-cta:hover i{
  transform: rotate(360deg) scale(1.05);
}
.hb-navbar[data-component-id="navbar"] .discord-cta::after{
  content:""; position:absolute; inset:-2px; border-radius:inherit; opacity:0; pointer-events:none;
  background: linear-gradient(120deg, rgba(255,255,255,.35) 8%, transparent 12%, transparent 88%, rgba(255,255,255,.35) 92%);
  transform: translateX(-60%);
}
.hb-navbar[data-component-id="navbar"] .discord-cta:hover::after{
  opacity:.55; animation: hbSheen 1.1s linear both;
}
@keyframes hbSheen{ to{ transform: translateX(60%) } }

.hb-navbar[data-component-id="navbar"] .cart-btn{
  position:relative; display:inline-grid; place-items:center;
  border:1px solid var(--stroke); border-radius:10px; padding:8px 10px; color:#fff;
  background:#171319;
}
.hb-navbar[data-component-id="navbar"] .cart-btn .icon{ width:20px; height:20px; }
.hb-navbar[data-component-id="navbar"] .cart-btn .count{
  position:absolute; top:-6px; right:-6px; background:linear-gradient(90deg,#ff88bd,var(--accent));
  color:#101114; font-weight:900; font-size:12px; border-radius:999px; padding:2px 6px;
  box-shadow: 0 6px 16px rgba(255,90,160,.35);
}

.hb-navbar[data-component-id="navbar"] .currency-selector select{
  appearance:none; -webkit-appearance:none;
  background:#171319; color:#fff; border:1px solid var(--stroke);
  padding:8px 10px; border-radius:10px; font-weight:700; letter-spacing:.02em;
}

.hb-navbar[data-component-id="navbar"] .navbar-toggler{
  border:1px solid var(--stroke); border-radius:10px; background:#171319; padding:8px 10px;
}
.hb-navbar[data-component-id="navbar"] .navbar-toggler-icon{
  width:20px; height:2px; background:#fff; position:relative; display:block;
}
.hb-navbar[data-component-id="navbar"] .navbar-toggler-icon::before,
.hb-navbar[data-component-id="navbar"] .navbar-toggler-icon::after{
  content:""; position:absolute; left:0; right:0; height:2px; background:#fff;
}
.hb-navbar[data-component-id="navbar"] .navbar-toggler-icon::before{ top:-6px }
.hb-navbar[data-component-id="navbar"] .navbar-toggler-icon::after { top: 6px }

.hb-navbar[data-component-id="navbar"].is-scrolled{
  box-shadow: 0 10px 26px rgba(0,0,0,.45);
}
</style>

<script>
(function(){
  const nav = document.querySelector('.hb-navbar[data-component-id="navbar"]');
  if(!nav) return;

  const here = location.pathname.replace(/\/+$/,'').toLowerCase();
  nav.querySelectorAll('.nav-link').forEach(a=>{
    const href = (a.getAttribute('href')||'').replace(/^https?:\/\/[^/]+/,'').replace(/\/+$/,'').toLowerCase();
    if(href && href === here) a.classList.add('active');
  });

  const setShadow = ()=> nav.classList.toggle('is-scrolled', window.scrollY > 4);
  setShadow(); window.addEventListener('scroll', setShadow, {passive:true});

  const hoverables = nav.querySelectorAll('.nav-link, .nav-ghost');
  hoverables.forEach(el=>{
    el.addEventListener('mousemove', e=>{
      const r = el.getBoundingClientRect();
      el.style.setProperty('--mx', (e.clientX - r.left) + 'px');
      el.style.setProperty('--my', (e.clientY - r.top)  + 'px');
    }, {passive:true});
    el.addEventListener('mouseleave', ()=>{
      el.style.removeProperty('--mx'); el.style.removeProperty('--my');
    });
  });
})();
</script>